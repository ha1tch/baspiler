10 DECLARE PACMAN AS SPRITE
20 DECLARE GHOST AS SPRITE
30 DECLARE DOTS AS ARRAY(100) ' Supports up to 100 dots
40 DECLARE GAMEOVER AS BOOLEAN
50 DECLARE SCORE AS INTEGER
60 GAMEOVER = FALSE
70 SCORE = 0
80 DOT_COUNT = 0

90 CANVASWIDTH = 800
100 CANVASHEIGHT = 600

110 ' Key constants
120 CONST KEY_LEFT = 37
130 CONST KEY_RIGHT = 39
140 CONST KEY_UP = 38
150 CONST KEY_DOWN = 40

160 ' Define the Pac-Man pixmap (20x20 grid)
170 BEGINSPRITE PACMAN, WIDTH 20, HEIGHT 20
180   PIXMAP [ [0, 0, 12, 12, 12, 12, 0, 0],
190              [0, 12, 12, 12, 12, 12, 12, 0],
200              [12, 12, 12, 12, 12, 12, 12, 12],
210              [12, 12, 12, 12, 12, 12, 12, 12],
220              [0, 0, 12, 12, 12, 12, 0, 0] ]
230 ENDSRITE

240 ' Define the ghost pixmap (20x20 grid)
250 BEGINSPRITE GHOST, WIDTH 20, HEIGHT 20
260   PIXMAP [ [0, 0, 3, 3, 3, 3, 0, 0],
270              [0, 3, 3, 3, 3, 3, 3, 0],
280              [3, 3, 3, 3, 3, 3, 3, 3],
290              [3, 3, 3, 3, 3, 3, 3, 3],
300              [0, 0, 3, 3, 3, 3, 0, 0] ]
310 ENDSRITE

320 ' Define dot structure
330 TYPE DOT
340   X AS INTEGER
350   Y AS INTEGER
360   ACTIVE AS BOOLEAN
370 END TYPE

380 ' Initialize dots
390 FOR I = 0 TO 99
400   DOTS(I).ACTIVE = TRUE
410   DOTS(I).X = RND(CANVASWIDTH - 10)
420   DOTS(I).Y = RND(CANVASHEIGHT - 10)
430 NEXT I

440 ' Initialize game variables
450 PACMAN.X = CANVASWIDTH / 2 - 10
460 PACMAN.Y = CANVASHEIGHT / 2 - 10
470 GHOST.X = RND(CANVASWIDTH)
480 GHOST.Y = RND(CANVASHEIGHT)

490 SUB DRAWGAMEOVER
500   SETFONT "Arial", 30
510   SETCOLOR 7 ' White
520   DRAWTEXT "GAME OVER", CANVASWIDTH / 2, CANVASHEIGHT / 2, ALIGNCENTER
530   DRAWTEXT "SCORE: " + SCORE, CANVASWIDTH / 2, CANVASHEIGHT / 2 + 40, ALIGNCENTER
540 END SUB

550 SUB DRAWSCORE
560   SETFONT "Arial", 20
570   SETCOLOR 7 ' White
580   DRAWTEXT "SCORE: " + SCORE, 10, 10, ALIGNLEFT
590 END SUB

600 SUB DRAWPACMAN
610   DRAWSPRITE PACMAN, PACMAN.X, PACMAN.Y
620 END SUB

630 SUB DRAWSGHOST
640   DRAWSPRITE GHOST, GHOST.X, GHOST.Y
650 END SUB

660 SUB DRAWDOTS
670   FOR I = 0 TO 99
680      IF DOTS(I).ACTIVE THEN
690         DRAWCIRCLE DOTS(I).X, DOTS(I).Y, 5 ' Draw dot as a small circle
700      END IF
710   NEXT I
720 END SUB

730 SUB MOVEGHOST
740   ' Simple ghost movement
750   GHOST.X = GHOST.X + RND(3) - 1 ' Random move in X direction
760   GHOST.Y = GHOST.Y + RND(3) - 1 ' Random move in Y direction
770   IF GHOST.X < 0 THEN GHOST.X = 0
780   IF GHOST.X > CANVASWIDTH - 20 THEN GHOST.X = CANVASWIDTH - 20
790   IF GHOST.Y < 0 THEN GHOST.Y = 0
800   IF GHOST.Y > CANVASHEIGHT - 20 THEN GHOST.Y = CANVASHEIGHT - 20
810 END SUB

820 SUB MOVEPACMAN
830   IF KEYISDOWN(KEY_LEFT) THEN PACMAN.X = PACMAN.X - 5
840   IF KEYISDOWN(KEY_RIGHT) THEN PACMAN.X = PACMAN.X + 5
850   IF KEYISDOWN(KEY_UP) THEN PACMAN.Y = PACMAN.Y - 5
860   IF KEYISDOWN(KEY_DOWN) THEN PACMAN.Y = PACMAN.Y + 5
870 END SUB

880 SUB CHECKCOLLISION
890   ' Check for collision with dots
900   FOR I = 0 TO 99
910      IF DOTS(I).ACTIVE AND PACMAN.X + 20 > DOTS(I).X AND PACMAN.X < DOTS(I).X + 10 AND _
920         PACMAN.Y + 20 > DOTS(I).Y AND PACMAN.Y < DOTS(I).Y + 10 THEN
930         DOTS(I).ACTIVE = FALSE
940         SCORE = SCORE + 10
950      END IF
960   NEXT I

970   ' Check for collision with ghost
980   IF PACMAN.X + 20 > GHOST.X AND PACMAN.X < GHOST.X + 20 AND _
990      PACMAN.Y + 20 > GHOST.Y AND PACMAN.Y < GHOST.Y + 20 THEN
1000      GAMEOVER = TRUE
1010   END IF
1020 END SUB

1030 SUB MAINLOOP
1040   IF NOT GAMEOVER THEN
1050      CLEARSCREEN
1060      CALL DRAWSCORE
1070      CALL DRAWPACMAN
1080      CALL DRAWSGHOST
1090      CALL DRAWDOTS
1100      CALL MOVEPACMAN
1105      CALL MOVEGHOST
1106      CALL CHECKCOLLISION
1110   ELSE
1115      CALL DRAWGAMEOVER
1120   END IF
1125   REDRAW
1130   GOTO 1030
1140 END SUB

1150 CALL MAINLOOP
